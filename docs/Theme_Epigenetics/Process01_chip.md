# 1. Chip-seq笔记

## 1.1. 简介

ChIP-Seq 简介及目的：
- 我的概括：研究蛋白质（如转录因子、增强子）等到底是结合在基因组的哪一个具体位置的，从而可以清晰表述转录调控机制。【概括的怎么样？】  

Chip-seq：  
- 染色质免疫共沉淀技术（Chromatin Immunoprecipitation，ChIP）也称结合位点分析法，研究体内蛋白质与DNA相互作用的一种方法，通常用于转录因子结合位点或组蛋白特异性修饰位点的研究。
- 将ChIP与第二代测序技术相结合的ChIP-seq技术，能高效的在全基因组范围内检测与组蛋白、转录因子等互作的DNA片段。

> - **ChIP被用来研究细胞内DNA与蛋白质相互作用**，具体来说就是确定特定蛋白（如转录因子）是否结合特定基因组区域（如启动子或其它DNA结合位点）——可能定义顺反组。ChIP还被用来**确定基因组上与组蛋白修饰相关的特定位点**（即组蛋白修饰酶类的靶标） - [来自维基百科]。
> 
> - 明确知道感兴趣的转录因子是什么，根据感兴趣的转录因子设计抗体去做ChIP实验拉DNA，**验证感兴趣的转录因子是否与DNA存在相互作用**。  
> 
> - ChIP-seq用于鉴定能被某种蛋白质结合的基因组区域。


Chip研究已有成熟的数据库：
- [转录调控研究数据库推荐 | 你要找的ChIP-seq数据都在这里啦！ - 简书](https://www.jianshu.com/p/ec5ae887c16c)


## 1.2. Chip-seq的测序及基本分析流程

### 1.2.1. workflow

#### 1.2.1.1. 流程

[ENCODE3 pipeline v1 specifications](https://docs.google.com/document/d/1lG_Rd7fnYgRpSIqrIfuVlAz2dW1VaSQThzk836Db99c/edit#)


#### 1.2.1.2. 其他
流程1，简介[^1]：
- 质量控制， 用到的是FastQC
- 序列比对，Bowtie2或者BWA
- peak calling, 建议用MACS
- peak注释， 推荐Y叔的ChIPseeker

流程2：（[参考: 诺禾Chip-seq产品](https://www.novogene.com/tech/service/chip-seq/product/)）
- 测序数据质量评估 ：过滤掉低质量数据，保证数据质量
- 与参考基因组比对 ：scc分析，判断IP效果
- peak峰calling ：分析蛋白结合位点
- motif分析 ：蛋白结合序列的偏好性
- peak峰相关基因注释 ：寻找蛋白潜在调控基因
- 差异peak分析 ：分析不同样本间差异peak峰
- 相关基因功能分析 ：相关基因GO, KEGG富集分析

流程3，具体步骤[^2]：
- 测序部分
  - 第1步：将所有蛋白以及蛋白能结合的DNA固定下来（包括我们感兴趣的蛋白，也包括其他蛋白）
  - 第2步：将DNA打断至300bp的片段
  - 第3步：用可以结合我们感兴趣的蛋白的抗体去结合这些片段，并吸附
  - 第4步：除去各种蛋白。得到我们感兴趣的蛋白质可以特异结合的DNA片段
  - 第5步：加接头测序
- 数据分析部分
  - 数据过滤+比对到基因组（比对之后，可以得到很多位置区间）
  - 覆盖度计算（比对上的Reads）【未必对上的数据如何处理？】
  - 扫描Peak区域，确定peaks
    > 注意  
    > 需要对照（ChIP-seq的实验部分是类似的，唯一的区别是没有抗体结合这一步）  
    > 结合基因组浏览器更直观  
    > 需要统计学显著  
  - 后续挖掘 【目的是什么？找出它与DNA序列相关的区域？】
    - Peak关联的基因GO注释，KEGG通路预测
    - Peak区域在基因组上的位置分布
      > 结合peaks的位置（也就是蛋白结合DNA的位置）推测对于基因表达的影响
    - 确定重复区域中Peak分布

其他挖掘：
  - 是否可以找出motif


### 1.2.2. 疑问
如何理解peaks？
- 简而言之，它就是比对结果覆盖在基因组上的峰值而已。

为何会出现峰值，而不出现像WGS比对那样的整齐比对reads？
- 【待查】

Chip-seq中设置的对照是什么？如何理解这个对照？这个对照测的是什么，是相同区域而没有蛋白吗？
- 【待查】

> 摘录：  
> 比对的结果，可以打开IGV查看，和RNA-Seq最大的区别在于你能看到明显的峰，这就是peak。这类peak在全基因组上特别的多，我们无法用肉眼直接选择，因此就需要借助专门的工具查找。  
> 一般ChIP-Seq都需要提供一个对照组，也就是图中IgG。很明显的发现其他实验组有峰的区域在对照组中是没有的。而实验组没有峰的区域，对照组也没有，这样子就能提出背景噪声。

## 1.3. 与ATAC-seq的异同之处

重点：
- 背景：
  - 染色质在转录之前被组蛋白紧密折叠。而DNA的复制转录是需要将DNA的紧密结构打开，从而允许一些调控因子结合（转录因子或其他调控因子）。
  - 这部分打开的染色质，就叫开放染色质，打开的染色质允许其他调控因子结合的特性称为染色质的可及性（chromatin accessibility）。因此，认为染色质的可及性与转录调控密切相关。
- 研究（蛋白结合区域、染色质开放区域、核小体）的各种方法总结：
  - ChIP-Seq是揭示特定转录因子或蛋白复合物的结合区域，实际是研究DNA和蛋白质的相互作用，利用抗体将蛋白质和DNA一起富集，并对富集到的DNA进行测序。
  - DNase-Seq、ATAC-Seq、FAIRE-Seq都是用来研究开放染色质区域。DNase-Seq是用的DNase I内切酶识别开放染色质区域，而ATAC-seq是用的Tn5转座酶，随后进行富集和扩增；FAIRE-Seq是先进行超声裂解，然后用酚-氯仿富集。
  - MNase-Seq是用来鉴定核小体区域。
- 共同点：
  - ATAC和Chip-seq都是用于检测转录调控开始的区域，不同的是两种技术作用的区域不同。
- 区别：
  - ATAC-Seq是全基因组范围内检测染色质的开放程度。用此方法与其他方法结合筛查感兴趣的特定调控因子；
  - ChIP-Seq是明确知道感兴趣的转录因子是什么，根据感兴趣的转录因子设计抗体去做ChIP实验拉DNA，验证感兴趣的转录因子是否与DNA存在相互作用。

其他待挖掘信息：【怎么理解需要合适的对照？】

> ChIP-Seq富集序列存在以下特点：  
>   
> 开放染色质区域比紧密区域更易打断；  
> 重复序列会出现似乎被富集的现象  
> 序列在整个基因组上不均匀分布  
>   
> 因此，ChIP-Seq需要有合适的对照组，对照样本需要满足以下其中一个条件：  
> 没有IP（input DAN）  
> 没有抗体 ("mock IP")  
> 没有特定的抗体 (IgG "mock IP")  


# 2. Chip分析流程

- 比对
- 检峰

---
不错的参考文章：
- [ChIP-seq之检峰 - 简书](https://www.jianshu.com/p/0c272643f88b)  
  - get到双峰是如何来的（双端测序的两侧）。
  - get到如何根据蛋白的不同去定义双峰之间的宽度（蛋白类型+macs2预测命令）。


# 3. 听讲

比对后，去除某些区域，原因有可能是重复序列
- bedtools可以去除bam
MS --> 
SPP --> TF

生物学重复的两个样本，peak有一点交集就可以说是同一个peak


生成bed（处理多样本的bed区域问题）  
bedtools  
- 合并，merge。样品较少
- A - B
- 并集。应用，多个样品确定最准确的peak区域

featurecount、deeptools  
- 定量

|      | bam1 | bam2 |
| ---- | ---- | ---- |
| bed1 | 123  | 132  |
| bed2 | 123  | 132  |

deeptools:
- bam --> bw
  1. 连续的。bin是从全基因组划分。（看整体）
  2. 非连续的。 <-- bed。（看局部）
- 画heatmap
  - A基因 10个peak结合在TSS两侧
  - B基因 8个peak
  - C基因 5个
- PCA 【PCA的计算方法？】
  - bam --> PCA
    - peak-sample 【转置问题】
      - 目的：检测样本重复性，样本聚类。

DiffBind:
- 封装了bedtools, deeptools, DESeq2


Anno
- 4种方法

motif

Pfam矩阵
- 基于denovo
- 基于Pfam数据库

统计频数
|     |  1  |  2  |  3  |  4  |  5  | ... | 200 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| A   | 60% |     |     |     |     |     |     |
| G   | 10% |     |     |     |     |     |     |
| T   | 0%  |     |     |     |     |     |     |
| C   | 30% |     |     |     |     |     |     |
|     | A   | ... |     |     |     |     |     |


Stand-shift

CTCF

# 3. 参考

- [ ] [第1篇：ATAC-seq的背景介绍以及与ChIP-Seq的异同 - 简书](https://www.jianshu.com/p/87bc2002e82c)  
  【详细的表观遗传介绍，对比ATAC等技术一起介绍，有很多东西尚待挖掘】


好文章：
- [ ] [ChIP-seq笔记_sunyu_03的博客-CSDN博客_chip-seq](https://blog.csdn.net/sunyu_03/article/details/82766641)  
  【详细介绍了每个命令的用法，基本可以跟着这个教程走一遍了】  
  类似的：https://blog.csdn.net/weixin_41745858/article/details/82628775


[^1]: - [ ] [ChIP-seq基础入门 - 简书](https://www.jianshu.com/p/a7b6ce208f98)   
  【后续分析流程概括的很到位，并结合文章的目的描述CHip-seq的应用，值得继续挖掘（该文章的质量极高，包含了其他教程链接，**值得深入挖掘**）】

[^2]: - [x] [ChIP-seq简介 - 简书](https://www.jianshu.com/p/a17f2870addd)  
  【步骤简介+图解】




# 疑惑问题汇总

CHIP 的 input 是什么， input有多重要？ keyword: `chip input 目的`

- [ChIP测序中的input有多重要？实验、数据分析都离不了](http://www.360doc.com/content/19/0218/03/52645714_815766998.shtml)